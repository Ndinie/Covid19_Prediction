# -*- coding: utf-8 -*-
"""Covid19_Prediction_module.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1SLDaRNiB3x5XaRfT6Wp4893zod_1T59C

IMPORT NECESSARY PACKAGES
"""

import matplotlib.pyplot as plt
from tensorflow.keras.layers import Embedding
from tensorflow.keras import Sequential, Input
from tensorflow.keras.layers import LSTM, Dense, Dropout, Bidirectional

"""MODEL DEVELOPMENT"""

class ModelDevelopment:
  def sequential_model(self, input_shape,nb_class=1, 
                       nb_node=64, dropout_rate=0.1):
    '''
      this is simple 3 LSTM layer deep learning model
      Parameters
      ----------
      input_shape : TYPE
            DESCRIPTION.
        nb_node : TYPE, optional
            DESCRIPTION. The default is 128.
        dropout_rate : TYPE, optional
            DESCRIPTION. The default is 0.3.
        output : TYPE, optional
            DESCRIPTION. The default is 1.
        Returns
        -------
        None.
    '''
    model = Sequential()
    model.add(Input(shape=(input_shape)))
    model.add(LSTM(nb_node, return_sequences=(True)))
    model.add(Dropout(dropout_rate))
    model.add(LSTM(nb_node))
    model.add(Dropout(dropout_rate))
    model.add(Dense(nb_class, activation='relu'))
    model.summary()
    
    return model

"""MODEL EVALUATION"""

class ModelEvaluation:
  def plot_hist_graph(self,hist,mse=2,valmse=5):
    k = list(hist.history.keys())

    plt.figure()
    plt.plot(hist.history[k[mse]])
    plt.plot(hist.history[k[valmse]])
    plt.legend(['Training MSE', 'Validation MSE'])
    plt.show()

class Figures:
  def plot_fig(self,y_test,predicted_new_cases):
    plt.figure()
    plt.plot(y_test,color='c')
    plt.plot(predicted_new_cases,color='m')
    plt.xlabel('Day')
    plt.ylabel('Covid19 New Cases')
    plt.legend(['Actual','Predicted'])
    plt.show()